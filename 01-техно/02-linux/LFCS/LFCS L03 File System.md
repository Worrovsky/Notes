# Linux Foundation Certified System Administrator (LFCS)

## Lesson 3 File system

`/` - корневая директория 
остальные директории размещаются в ней по правилам Filesystem Hierarchy Standart (FHS)
FHS определяет например /boot, /usr, /var  и др
концепция mount: директории размещаются на разделах жесткого диска (например /home размещается на /dev/sdb1)
`~` - домашняя директория пользователя

Работа в терминале
* `cd` - переход в директорию
* `cd /` - переход в корневую директорию
* `hier` - описание файловой системы по FHS
* `ls` - перечень файлов в текущей директории

#### Команда ls (просмотр директорий)

* выводит перечень файлов
* `ls -a` - выводит все файлы, в том числе скрытые (с `.`)
* `ls -l` - расширенная информация с правами, датой создания и пр.
* `ls -R` - отображает директории вместе с содержимым рекурсивно
* `ls -t` - сортирует список файлов по дате создания, новые - первыми
* `ls -lrt` - отсортированный по дате создания список файлов, новые - последние (аргумент `r`)
* можно указывать параметром путь к директории, например `ls -l home/`, будет выведено содержимое параметра
* с аргументом `d` выводится информация не о содержимом, а о текущей директории
* `tree` - графическое отображение иерархии

#### Wildcards

* `*` - любое количество любых символов, в т.ч. их отсутствие
* `?` - один любой символ
* `[0-9]` `[a-d]` - диапазон символов

#### Команда cp (копирование файлов)

`cp <источник> <приемник>`
* Если указать приемник без `/` в конце, тогда будет создан файл и в него будет помещено содержимое источника
* Если приемником предполагается папка, следует указывать `/` в конце

#### Работа с директориями

* `cd` - смена текущей рабочей директории
* `pwd` - печать текущей директории
* `mkdir` - создает директории
    - можно создавать сразу вложенные, но с аргументом `-p`: `mkdir -p /photos/2017`
* `rmdir` - удаляет пустую директорию

#### Перемещение файлов

* `mv <что> <куда>`
* можно `mv <что> ~` - в домашнюю папку
* если в пределах одной директории - переименование

#### Удаление файлов и директорий

* `rm <что>`
* `rm -r <что>` - удаление директории и ее содержимого (рекурсивно). Будет запрашиваться подтверждение
* `rm -rf <что>` - подавляет подтверждение на удаление

#### Ссылки

* 2 вида ссылок 
    - hard link
    - symbolic (soft) link
* файловая система linux построена на **inode** (индексный дескриптор)
* айнод содержит всю информацию о структуре файла (мета-инфо, ссылка на блоки на диске), но не имя файла и сами данные
* имя файла - это ссылка на айнод (это hard link)
* на один и тот же айнод может быть несколько ссылок
* при удалении hard-ссылки айнод остается и продолжают работать другие ссылки
* ограничения hard ссылок:
    - работают в пределах одного устройства
    - нельзя ссылаться на директории
* ссылка на hard-ссылку - это символьная ссылка (symbolic link)
* не имеет ограничений hard-ссылок:
    - можно на разных устройствах
    - можно на директории
* при удалении hard-ссылки, символьная ссылка перестает работать

##### Создание ссылок

Команда `ln`:
* `ln <исходный файл> <имя ссылки>` - создает hard-ссылку
* `ln -s <исходный файл/директория> <имя ссылки>` - создает символьную ссылку
* если просматривать исходный файл и ссылку командой `ls -l` для hard-ссылки обе записи будут идентичны
* даже номер айнода (можно посмотреть `ls -il`)
* для символьной запись отличается от исходного файла/директории

#### Поиск

Команда `find <где искать> [options] <что>`
Примеры:
* `find /etc -name hosts` - искать в директории /etc файлы с именем 'hosts'
* `find /etc -name "*hosts*"` - то же, но содержащие в имени
* `find / -user test` - поиск файлов с указаным пользователем
* + много другого
* многие атрибуты допускают числовые значения
    - `+n` - больше чем n
    - `-n` - меньше
    - `n` - точно равно
* например `find /etc -size +100k` - найти файлы больше 100КБ
* `find` комбинируется с другими командами через действие `-exec`
    - `{}` - результат выполнения команды find, который передается в следущую команду
    - комбинация должна завершаться `\;`
    - пример `find /etc -name "del* -exec cp {} /dev/null \;`
* поиск внутри файлов `find /etc -exec grep <что> {} \; -exec cp {} /...`