## RESTFULL

https://habr.com/ru/company/yandex/blog/265569/
http://www.restapitutorial.ru/lessons/httpmethods.html

### 1. URL как ресурс

действия в URL не выполнять

так не надо: `GET /?method=шарахнуть&to=Луна`
так надо: `POST /шарахалка/?to=Луна`

в имени ресурса - существительные, иерархия; действия(глаголы) выражены через метод
ресурсы проще создавать детальные (тупо СRUD), потом переходить к сложным, чем наоборот

связность ресурсов: напр. POST создает ресурс и в ответе возвращает в Location ссылку на созданный ресурс

рекомендация - множестенное число ресурсов

### 2. Состав URL

путь - для организации иерархии
запрос - для неиерархических ресурсов и для параметров
фрагмент - для идентификации ресурса (редко используется)

### 3. Методы HTTP

при запросе применяется метод (глагол) к ресурсу
напр. **GET** получает ресурс, **DELETE** - удаляет ресурс

### 4. Безопасные методы

**GET**, **HEAD**, **OPTIONS** - безопасные (предполагается, что не меняют состояние ресурса)

Сетевые агенты (браузеры) могут скрытно ходить по таким методам, считая что ничего не изменят

### 5. Кеширование

**GET**, **HEAD** кешируются по умолчанию

### 6. Симметричные методы

**PUT** кладет что-то по URL, **GET** получает это, **DELETE** удаляет

**HEAD** - синоним **GET**, но не аозвращает тело ответа

### 7. POST / идемпотентность

Применяется когла нет ресурса, для которого можно применить операцию

напр. `PUT /treads/messages/245` - знаем id сообщения
но `POST /threads/messages` - не знаем, сервер будет решать

Идемпотентность - повторение запроса не меняет состояние сервера (именно сервера, ответы могут быть разными)

PUT, GET, DELETE(конкретной записи) - идемпотентны
POST - нет

### 8. PUT / PATCH

**PUT** - изменяет или создает ресурс. Но в любом случае внутри передается полное представление ресурса
**PATCH** - модифицирует ресурс, без полной перезаписи (неидемпотентый)
 
### 9. Ответы

Нужны, чтобы клиент понял что ему делать

3хх - нужно что-то делать
4хх - клиент неправильно сформировал запрос, нужно переделать, повторять бессмысленно (искл. 404). Рекомендуется включать описание ошибки
5хх - клиент всё правильно, у сервера проблемы

Обычно:
GET - 200
PUT - 201(ресурс создан) или 200 (обновлен)
DELETE - 204 (успешно, возвращать нечего)
POST - 200 или 201 (с указанием location на созданный ресурс)

### 10. Грабли

* 401 должен быть с заголовком WWW-Authenticate, т. е. только при HTTP-аутентификации, в остальных случаях - 403 Forbidden
* 3xx - не только редиректы, но и доп. действия. Напр. 304 Not Modified - клиент берет из кеша
* 404 - клиент может повторять. Говорит что ресурса сейчас нет, но может быть появится. 410 - ресурс удален

### 11. Capability URL

URL с ресурсом и действием над ним
напр. ссылка на восстановление паролей


