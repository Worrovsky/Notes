# Заметки / Spring in Action

## Ch 2.

@SpringBootApplication как три аннотации @Configuration, @ComponentScan, @enableAutoConfiguration

запуск:

* плагины gradle, maven
* сборка в jar и запуск jar

стартеры - как источники зависимостей
можно переопределять:

* исключить зависимость:
    - exclude (gradle)
    - exclusion (maven)
* изменить версию:
    - gradle: исключить из стартера, добавить свою
    - maven: просто добавить, переопределяется

Автоконфигурация под капотом:

аннотации по проверке классов в classpath @Condition
проверка наличия бинов @ConditionOnBean
и др.

## Ch 3. Пользовательская настройка

### Переопределение бинов

в основном бины автоконфигурации имеют аннотацию @ConditionalOnMissingBean
поэтому если создали свой - бин автоконфигурации не создается

Второй способ: настройки через properties

### Внешние настройки-свойства

Источники свойств (по убыванию приоритета):

* аргументы командной строки
* JNDI атрибуты из java:comp/env
* JVM системные свойства
* переменные среды ОС
* случайные значения для свойств с префиксом random
* cвойства в файлах `application.properties` или `application.yml` вне приложения
* cвойства в файлах `application.properties` или `application.yml`, упакованных внутри приложения
* свойства, заданные через `@PropertySource`
* свойства по умолчанию

как задавать свойства:

* консоль `java-jar myapp.jar --spring`

Места расположения файлов свойств (по убыванию приоритета)

* внешний, в директории `/config` в директории, откуда запущено приложение
* внешний, в директории, откуда запущено приложение
* внутренний, в пакете `config`
* внутренний, в корне classpath

попробовать свойства:

    * аргумент ком. строки
    * .properties
    * системная переменная
    * внедрить свойство в бин

### Внедрение свойств в бины

* в классе-бине вводим обычное поле с сеттером
* сам класс помечаем аннотацией `@ConfigurationProperties(prefix="myPrefix")`
* теперь достаточно любым способом задать внешнее свойство с именем `myPrefix.<ИмяПоля>`
* оно будет внедрено в бин

что-то про `@EnableConfigurationProperties`, но вроде она автоматически включается ???

имена в виде camelCase, c дефисамми, подчеркиваниями равнозначны

можно свойства вывести в отдельный класс (`@Component @ConfigurationProperties`) и через автосвязывание например внедрить в основно класс

### Профили

* Бин помечается аннотацией `@Profile("<ИмяПрофиля>")`
* текущий профиль устанавливается через свойство `spring.profiles.active`
* если профиль бина (при наличии????) не совпадает с активным профилем, бин не загружается

### Профили для набора свойств

* есть обычный файл свойств `appllication.properties`
* профилезависимые свойства переопределяем в файле `application-{profile}.properties`
* для yaml или также несколько файлов, или можно в одном файле разделить свойства по профилям

### Настройка страницы ошибок





