# Работа с файловой системой (NIO.2)

[oracle tutorial](https://docs.oracle.com/javase/tutorial/essential/io/fileio.html)

## 1. Путь (path) и другие факты

Что такое путь: представление файлы/директории в иерархии файловой системы

**Абсолютный путь** - начинается с корневого элемента файловой системы (`/` - для UNIX, `C:\` и т. п. для Win)

**Относительный путь** - не содержит корневого элемента, для доступа к файлу нужно объединять с другим абсолютным путем

**Символические ссылки** - элемент файловой системы (как и папки, файлы), указывает на другой элемент ФС (в т. ч. другую симссылку). С точки зрения приложений чтение/запись в симссылку равноценна чтению/записи напрямую в файл. Но переименование, удаление влияет применяется только для ссылки

## 2. Интерфейс Path

### 2.1 Основы

`java.nio.file.Path`

представляет путь в файловой системе

зависит от операционной системы

никак не связан с наличием файла, на который указывает. Для проверки существования, удаления и других операций используется класс `Files`

Методы класса позволяют создавать, модифицировать и т. п. пути. 

### 2.2 Создание объекта Path

Через метод **Paths.get()**

    Path p = Paths.get("tmp/foo");
    // комбинацией частей:
    Path p2 = Paths.get(System.getProperty("user.home"), "logs", "foo.log");

Синоним для 

    Path p3 = FileSystems.getDefault().getPath(".....");

Есть аналог **Path.of()**

### 2.3 Получение информации о пути

Путь представлен как массив составляющих его элементов. Поэтому доступны следующие методы:

    getNameCount() - возвращает количество элементов в пути
    getFileName() - возвращает последний элемент в пути
    getRoot()
    getParent()
    subpath(0, 2

Методы платформозависимы. Т. е. если создаем путь в синтаксисе Win и запускаем в Linux, не сможет определить root, составные части и т. п.

### 2.4 Удаление избыточности 

Например путь может содержать `.` или `..`. Чтобы избавиться от этого - метод **normalize()**
    
    Path p1 = Paths.get("/home/./joe/foo");
    Path p2 = Paths.get("/home/sally/../joe/foo");
    p1 = p1.normalize(); // теперь /home/joe/foo
    p2 = p2.normalize(); // теперь /home/joe/foo

Этот метод также не проверяет / никак не взаимодействует с реальным файлом

### 2.5 Конвертация путей

**toUri()** 

    Path p = Paths.get("/home/foo");
    p.toUri(); // file:///home/foo

**toAbsolutePath()** - преобразует в абсолютный путь (обычно присоединением текущей рабочей директории)

**toRealPath()** - удаляет избыточность, преобразует в абсолютный путь. Можно передать параметром, как обрабатывать симлинки. Проверяет наличие файла в системе. Выбрасывает исключение, если файла нет или ошибки доступа

### 2.6 Объединение путей

метод **resolve()**

можно передать в него частичный путь, объединяется с исходным. Если передан абсолютный, он же и возвращается

    Path p = Paths.get("/home/foo");
    p.resolve("bar"); // "/home/foo/bar"
    p.resolve("/home/bar"); // "/home/bar"

### 2.7 